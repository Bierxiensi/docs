---
title: 入门区块链
search: true

date: 2021-06-17 19:05:23
tags: [区块链]
photos:
description:
comments:
---

# 简介
- 本质：特殊的分布式数据库
- 目的：电子化数据储存方法
- 特点：去中心化（低成本的方式来实现可靠的契约关系）

# 详情
## 一、区块
![avatar](./img/clipboard.png)

### keyword
- 区块头（Head）：时间戳、哈希（SHA256函数生成）、Merkle Root
- 区块体（Body）：实际数据
- 哈希：SHA256是区块链的哈希算法、哈希由区块头唯一决定。这意味着，如果当前区块体的内容变了，或者上一个区块的哈希变了，一定会引起当前区块的哈希改变。正是通过这种联动机制，区块链保证了自身的可靠性，数据一旦写入，就无法被篡改。
<pre><code>
  Hash = SHA256( 区块头 )
</code></pre>
![avatar](./img/clipboard1.png)
![avatar](./img/clipboard2.png)
## 二、默克尔树（Merkle Root）
- 作用：通过节点hash计算交易在区块，从而验证交易
![avatar](./img/clipboard3.png)
![avatar](./img/clipboard4.png)

## 三、产生流程
1\. 数据交易
> 比特币区块链是现存历史最悠久的区块链，在比特币区块链上，每个区块的大小在 1 MB 左右。
发生交易，产生数据

2\.（通过哈希运算）链接区块
![avatar](./img/clipboard5.png)

有三个独立的交易数据产生的区块，其中区块一根据其内部数据串生成一个特殊的（数字）签名
![avatar](./img/clipboard6.png)

将区块一的签名放到区块二中，区块一与区块二产生关联，后续区块逐次添加前一区块产生的签名，关联成链
![avatar](./img/clipboard7.png)

若区块一被修改，由于关联存在，后续每一区块需要重新计算其签名，理论上不可行，因而保证了其不可篡改性。
![avatar](./img/clipboard8.png)

3\. 生成签名（哈希值）
在区块链上，区块签名是通过密码学哈希函数生成的。密码学哈希函数是一个极其复杂的数学公式：将任意数据串作为输入值代入公式，可以得到一个独一无二的 64 位输出值。
![avatar](./img/clipboard9.png)

哈希函数的种类有很多，对于同一个密码学哈希函数来说，相同的输入必定会得到相同的输出，不同的输入必定会得到不同的输出。

4\. 合格的签名与区块签署
并非所有的签名都符合要求。区块链协议会预先确定一些要求，比如，在比特币区块链上，只有以连续的零开头的数字签名相对应的区块才能上链。（因此可以调整零的个数来应对算力增加）
![avatar](./img/clipboard10.png)

由上图知，每个区块里面还另外添加了一段特定长度的、可以改动的数据，这段数据就是区块的 <font color=red>nonce</font> 。由于交易数据和元数据（区块编号、时间戳等等）需要保持原样（否则意义就改变了）。所以需要反复更改 nonce、对区块数据进行哈希运算。
<font color=red>寻找合格签名的过程就叫做挖矿</font>，也就是矿工所做的事。矿工投入大量电力，转化成算力，不断代入 nonce 进行哈希运算，直到找到合格的签名（输出）为止。矿工手中掌握的算力越多，哈希运算的速度就越快，抢先找到合格签名的可能性就越高。这是一种反复试错的过程。

5\. 区块链的不可变性
 “最长链规则”，是 Nakamoto Concensus（中本聪共识机制）的一部分。（并不是所有区块链都采用了中本聪共识），攻击者只有制造出一条比当前主链更长的链，才能成功改变大家共同认可的交易记录，这就要求攻击者的算力超过全网其他人的算力总和，叫做 51% 攻击。
![avatar](./img/clipboard11.png)

6\. 区块链的不可变性
区块链协议自动以最长链上的交易记录为准，将这条链视为代表绝大多数参与者的链。打造最长链需要消耗全网绝大部分算力。被篡改过的区块就与最长链断开了链接，因此会被全网绝大多数节点自动拒绝